# Example Custom Values
# Copy this file and customize for your environment
# Usage: helm install my-release ./airflow-health-dashboard -f my-values.yaml

# Container images configuration
global:
  imageRegistry: ""  # e.g., "mycompany.azurecr.io"
  imagePullSecrets: []
    # - name: acr-secret

backend:
  replicaCount: 2
  
  image:
    repository: airflow-health-backend
    tag: "latest"
    pullPolicy: IfNotPresent
  
  # Your Airflow configuration
  airflow:
    baseUrl: "http://airflow-webserver:8080"
    authMethod: "basic"  # or "token"
    # For basic auth:
    username: "admin"
    password: "admin"
    # For token auth:
    # apiToken: ""
  
  # Caching configuration
  cache:
    ttlSeconds: 120
    refreshIntervalSeconds: 300
  
  # LLM configuration for AI-powered failure analysis
  llm:
    enabled: true
    provider: "azure_openai"  # Options: azure_openai, openai, anthropic
    model: "gpt-4o"
    
    # Azure OpenAI settings
    azureOpenAI:
      endpoint: ""  # e.g., "https://your-resource.openai.azure.com/"
      apiVersion: "2024-08-01-preview"
      deploymentName: ""  # e.g., "gpt-4o"
  
  # Slack integration for notifications
  slack:
    enabled: false
  
  # Scheduled reports
  scheduledReports:
    enabled: false
    morningReportHour: 10
    morningReportMinute: 0
    eveningReportHour: 19
    eveningReportMinute: 0
    dashboardUrl: "https://dashboard.yourcompany.com"
  
  # CORS origins (adjust for your domain)
  corsOrigins:
    - "http://localhost:3000"
    - "http://localhost"
  
  logLevel: "INFO"  # DEBUG, INFO, WARNING, ERROR
  
  # Resource limits
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi
  
  # Autoscaling (optional)
  autoscaling:
    enabled: false
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 80

frontend:
  replicaCount: 2
  
  image:
    repository: airflow-health-frontend
    tag: "latest"
    pullPolicy: IfNotPresent
  
  # API URL (internal service name)
  apiUrl: "http://backend:8000/api/v1"
  
  # Airflow URL (for direct links from frontend)
  airflowUrl: "http://airflow-webserver:8080"
  
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi

# Redis configuration
redis:
  enabled: true
  
  # Use external Redis (if you have one)
  external:
    enabled: false
    url: "redis://redis-master:6379"
  
  # Internal Redis settings (if not using external)
  persistence:
    enabled: true
    storageClass: ""  # Use default storage class
    size: 8Gi

# Ingress configuration (for external access)
ingress:
  enabled: false
  className: "nginx"
  annotations: {}
    # cert-manager.io/cluster-issuer: "letsencrypt-prod"
  
  hosts:
    - host: airflow-health.example.com
      paths:
        - path: /
          pathType: Prefix
          backend: frontend
        - path: /api
          pathType: Prefix
          backend: backend
  
  tls: []
    # - secretName: airflow-health-tls
    #   hosts:
    #     - airflow-health.example.com

# Secrets configuration
# IMPORTANT: For production, use external secret management
# (Sealed Secrets, External Secrets Operator, etc.)
secrets:
  create: true
  airflowUsername: "admin"
  airflowPassword: "admin"
  airflowApiToken: ""
  llmApiKey: ""
  slackWebhookUrl: ""

# Service account
serviceAccount:
  create: true
  annotations: {}
  name: ""

# Network policies (for additional security)
networkPolicy:
  enabled: false

# Pod disruption budgets (for high availability)
podDisruptionBudget:
  enabled: false
  minAvailable: 1
